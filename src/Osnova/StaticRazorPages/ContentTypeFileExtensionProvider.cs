namespace Osnova.StaticRazorPages;

public class ContentTypeFileExtensionProvider : IContentTypeFileExtensionProvider
{
    public IDictionary<string, string> Mappings { get; }

    public ContentTypeFileExtensionProvider()
        : this(new Dictionary<string, string>
    {
        {"application/atom+xml",".atom"},
        {"application/directx",".x"},
        {"application/envoy",".evy"},
        {"application/font-woff",".woff"},
        {"application/fractals",".fif"},
        {"application/futuresplash",".spl"},
        {"application/hta",".hta"},
        {"application/internet-property-stream",".acx"},
        {"application/java-archive",".jar"},
        {"application/javascript",".js"},
        {"application/json",".json"},
        {"application/mac-binhex40",".hqx"},
        {"application/manifest+json",".webmanifest"},
        {"application/octet-stream",".bin"},
        {"application/oda",".oda"},
        {"application/ogg",".ogx"},
        {"application/oleobject",".ods"},
        {"application/olescript",".axs"},
        {"application/opensearchdescription+xml",".osdx"},
        {"application/pdf",".pdf"},
        {"application/pics-rules",".prf"},
        {"application/pkcs10",".p10"},
        {"application/pkcs7-signature",".p7s"},
        {"application/pkix-crl",".crl"},
        {"application/rtf",".rtf"},
        {"application/set-payment-initiation",".setpay"},
        {"application/set-registration-initiation",".setreg"},
        {"application/streamingmedia",".ssm"},
        {"application/vnd.fdf",".fdf"},
        {"application/vnd.microsoft.portable-executable",".exe"},
        {"application/vnd.ms-cab-compressed",".cab"},
        {"application/vnd.ms-excel.addin.macroEnabled.12",".xlam"},
        {"application/vnd.ms-excel.sheet.binary.macroEnabled.12",".xlsb"},
        {"application/vnd.ms-excel.sheet.macroEnabled.12",".xlsm"},
        {"application/vnd.ms-excel.template.macroEnabled.12",".xltm"},
        {"application/vnd.ms-fontobject",".eot"},
        {"application/vnd.ms-office.calx",".calx"},
        {"application/vnd.ms-officetheme",".thmx"},
        {"application/vnd.ms-pki.certstore",".sst"},
        {"application/vnd.ms-pki.pko",".pko"},
        {"application/vnd.ms-pki.seccat",".cat"},
        {"application/vnd.ms-pki.stl",".stl"},
        {"application/vnd.ms-powerpoint.addin.macroEnabled.12",".ppam"},
        {"application/vnd.ms-powerpoint.presentation.macroEnabled.12",".pptm"},
        {"application/vnd.ms-powerpoint.slide.macroEnabled.12",".sldm"},
        {"application/vnd.ms-powerpoint.slideshow.macroEnabled.12",".ppsm"},
        {"application/vnd.ms-powerpoint.template.macroEnabled.12",".potm"},
        {"application/vnd.ms-project",".mpp"},
        {"application/vnd.ms-visio.viewer",".vdx"},
        {"application/vnd.ms-word.document.macroEnabled.12",".docm"},
        {"application/vnd.ms-word.template.macroEnabled.12",".dotm"},
        {"application/vnd.ms-xpsdocument",".xps"},
        {"application/vnd.openxmlformats-officedocument.presentationml.presentation",".pptx"},
        {"application/vnd.openxmlformats-officedocument.presentationml.slide",".sldx"},
        {"application/vnd.openxmlformats-officedocument.presentationml.slideshow",".ppsx"},
        {"application/vnd.openxmlformats-officedocument.presentationml.template",".potx"},
        {"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",".xlsx"},
        {"application/vnd.openxmlformats-officedocument.spreadsheetml.template",".xltx"},
        {"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".docx"},
        {"application/vnd.openxmlformats-officedocument.wordprocessingml.template",".dotx"},
        {"application/vnd.rn-realmedia",".rm"},
        {"application/vnd.wap.wmlc",".wmlc"},
        {"application/vnd.wap.wmlscriptc",".wmlsc"},
        {"application/wasm",".wasm"},
        {"application/winhlp",".hlp"},
        {"application/x-bcpio",".bcpio"},
        {"application/x-cdf",".cdf"},
        {"application/x-compress",".z"},
        {"application/x-compressed",".tgz"},
        {"application/x-cpio",".cpio"},
        {"application/x-csh",".csh"},
        {"application/x-dvi",".dvi"},
        {"application/x-gtar",".gtar"},
        {"application/x-gzip",".gz"},
        {"application/x-hdf",".hdf"},
        {"application/x-iphone",".iii"},
        {"application/x-java-applet",".class"},
        {"application/x-latex",".latex"},
        {"application/x-miva-compiled",".mvc"},
        {"application/x-ms-application",".application"},
        {"application/x-ms-manifest",".manifest"},
        {"application/x-ms-reader",".lit"},
        {"application/x-ms-vsto",".vsto"},
        {"application/x-ms-wmd",".wmd"},
        {"application/x-ms-wmz",".wmz"},
        {"application/x-ms-xbap",".xbap"},
        {"application/x-msaccess",".mdb"},
        {"application/x-mscardfile",".crd"},
        {"application/x-msclip",".clp"},
        {"application/x-msmetafile",".wmf"},
        {"application/x-msmoney",".mny"},
        {"application/x-mspublisher",".pub"},
        {"application/x-msschedule",".scd"},
        {"application/x-msterminal",".trm"},
        {"application/x-mswrite",".wri"},
        {"application/x-netcdf",".nc"},
        {"application/x-oleobject",".hhc"},
        {"application/x-pkcs7-certreqresp",".p7r"},
        {"application/x-quicktimeplayer",".qtl"},
        {"application/x-sh",".sh"},
        {"application/x-shar",".shar"},
        {"application/x-shockwave-flash",".swf"},
        {"application/x-silverlight-app",".xap"},
        {"application/x-smaf",".mmf"},
        {"application/x-stuffit",".sit"},
        {"application/x-sv4cpio",".sv4cpio"},
        {"application/x-sv4crc",".sv4crc"},
        {"application/x-tar",".tar"},
        {"application/x-tcl",".tcl"},
        {"application/x-tex",".tex"},
        {"application/x-troff-man",".man"},
        {"application/x-troff-me",".me"},
        {"application/x-troff-ms",".ms"},
        {"application/x-ustar",".ustar"},
        {"application/x-wais-source",".src"},
        {"application/x-x509-ca-cert",".crt"},
        {"application/x-zip-compressed",".zip"},
        {"application/xaml+xml",".xaml"},
        {"application/xhtml+xml",".xhtml"},
        {"audio/aac",".aac"},
        {"audio/mp4",".m4a"},
        {"audio/mpeg",".mp3"},
        {"audio/wav",".wav"},
        {"audio/x-aiff",".aif"},
        {"audio/x-mpegurl",".m3u"},
        {"audio/x-ms-wax",".wax"},
        {"audio/x-ms-wma",".wma"},
        {"audio/x-pn-realaudio-plugin",".rpm"},
        {"drawing/x-dwf",".dwf"},
        {"font/otf",".otf"},
        {"font/woff2",".woff2"},
        {"image/bmp",".bmp"},
        {"image/cis-cod",".cod"},
        {"image/gif",".gif"},
        {"image/ief",".ief"},
        {"image/jpeg",".jpg"},
        {"image/pjpeg",".jfif"},
        {"image/png",".png"},
        {"image/svg+xml",".svg"},
        {"image/tiff",".tiff"},
        {"image/vnd.rn-realflash",".rf"},
        {"image/vnd.wap.wbmp",".wbmp"},
        {"image/webp",".webp"},
        {"image/x-cmu-raster",".ras"},
        {"image/x-cmx",".cmx"},
        {"image/x-icon",".ico"},
        {"image/x-jg",".art"},
        {"image/x-portable-anymap",".pnm"},
        {"image/x-portable-bitmap",".pbm"},
        {"image/x-portable-graymap",".pgm"},
        {"image/x-portable-pixmap",".ppm"},
        {"image/x-rgb",".rgb"},
        {"image/x-xbitmap",".xbm"},
        {"image/x-xpixmap",".xpm"},
        {"image/x-xwindowdump",".xwd"},
        {"text/cache-manifest",".appcache"},
        {"text/css",".css"},
        {"text/csv",".csv"},
        {"text/dlm",".dlm"},
        {"text/h323",".323"},
        {"text/html",".html"},
        {"text/iuls",".uls"},
        {"text/javascript",".mjs"},
        {"text/jscript",".jsx"},
        {"text/markdown",".md"},
        {"text/plain",".txt"},
        {"text/richtext",".rtx"},
        {"text/scriptlet",".sct"},
        {"text/sgml",".sgml"},
        {"text/tab-separated-values",".tsv"},
        {"text/vbscript",".vbs"},
        {"text/vnd.wap.wml",".wml"},
        {"text/vnd.wap.wmlscript",".wmls"},
        {"text/webviewhtml",".htt"},
        {"text/x-component",".htc"},
        {"text/x-hdml",".hdml"},
        {"text/x-ms-odc",".odc"},
        {"text/x-setext",".etx"},
        {"text/x-vcard",".vcf"},
        {"text/xml",".xml"},
        {"video/mp4",".mp4"},
        {"video/webm",".webm"},
        {"video/x-flv",".flv"},
        {"video/x-ivf",".IVF"},
        {"video/x-ms-dvr",".dvr-ms"},
        {"video/x-ms-wm",".wm"},
        {"video/x-ms-wmp",".wmp"},
        {"video/x-ms-wmv",".wmv"},
        {"video/x-ms-wmx",".wmx"},
        {"video/x-ms-wtv",".wtv"},
        {"video/x-ms-wvx",".wvx"},
        {"video/x-msvideo",".avi"},
        {"video/x-sgi-movie",".movie"},
    })
    { }

    public ContentTypeFileExtensionProvider(IDictionary<string, string> mappings)
    {
        Mappings = mappings ?? throw new ArgumentNullException(nameof(mappings));
    }

    public bool TryGetFileExtension(string contentType, out string? extension)
    {
        int semicolonIndex = contentType.IndexOf(';');
        if (semicolonIndex > 0)
        {
            contentType = contentType.Remove(semicolonIndex);
        }

        return Mappings.TryGetValue(contentType, out extension);
    }
}